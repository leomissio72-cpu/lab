<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista de Compras Inteligente - Controle de Gastos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* RESET E CONFIGURAÇÕES GERAIS */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1300px;
            margin: 0 auto;
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            position: relative;
        }

        /* HEADER */
        header {
            background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
            color: white;
            padding: 40px 30px 30px;
            text-align: center;
            position: relative;
        }

        .dashboard-link {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 12px 25px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            z-index: 100;
        }

        .dashboard-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }

        /* APP CONTAINER */
        .app-container {
            padding: 35px;
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 35px;
        }

        @media (max-width: 1100px) {
            .app-container {
                grid-template-columns: 1fr;
            }
        }

        /* FORM SECTION */
        .form-section {
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            padding: 30px;
            border-radius: 18px;
            box-shadow: 8px 8px 16px #d9d9d9, -8px -8px 16px #ffffff;
            border-left: 6px solid #4b6cb7;
            animation: fadeIn 0.5s ease-out;
        }

        .form-section h2 {
            color: #182848;
            margin-bottom: 25px;
            font-size: 1.7rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .form-group {
            margin-bottom: 25px;
            position: relative;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 5px;
        }

        .form-row .form-group {
            flex: 1;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 700;
            color: #444;
            font-size: 1.05rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        input, select {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 1.05rem;
            transition: all 0.3s;
            background: #f9f9f9;
        }

        input:focus, select:focus {
            border-color: #4b6cb7;
            background: white;
            outline: none;
            box-shadow: 0 0 0 3px rgba(75, 108, 183, 0.2);
        }

        /* BUTTONS */
        button, .btn {
            cursor: pointer;
            border: none;
            border-radius: 12px;
            padding: 15px 25px;
            font-weight: 700;
            font-size: 1.1rem;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            text-decoration: none;
        }

        .btn-add {
            background: linear-gradient(135deg, #4b6cb7 0%, #3a5ca9 100%);
            color: white;
            width: 100%;
            font-size: 1.2rem;
            padding: 18px;
            margin-top: 10px;
        }

        .btn-add:hover {
            background: linear-gradient(135deg, #3a5ca9 0%, #2a4c99 100%);
            transform: translateY(-3px);
            box-shadow: 0 7px 15px rgba(75, 108, 183, 0.4);
        }

        .btn-clear {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
            color: white;
        }

        .btn-clear:hover {
            background: linear-gradient(135deg, #ff5252 0%, #ff3838 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 12px rgba(255, 107, 107, 0.4);
        }

        .btn-edit {
            background: linear-gradient(135deg, #51cf66 0%, #40c057 100%);
            color: white;
            padding: 10px 15px;
            font-size: 0.9rem;
        }

        .btn-edit:hover {
            background: linear-gradient(135deg, #40c057 0%, #2fa84f 100%);
            transform: translateY(-2px);
        }

        .btn-delete {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
            color: white;
            padding: 10px 15px;
            font-size: 0.9rem;
        }

        .btn-delete:hover {
            background: linear-gradient(135deg, #ff5252 0%, #ff3838 100%);
            transform: translateY(-2px);
        }

        .btn-export {
            background: linear-gradient(135deg, #4b6cb7 0%, #3a5ca9 100%);
            color: white;
        }

        .btn-export:hover {
            background: linear-gradient(135deg, #3a5ca9 0%, #2a4c99 100%);
            transform: translateY(-2px);
        }

        .btn-import {
            background: linear-gradient(135deg, #9c36b5 0%, #862e9c 100%);
            color: white;
        }

        .btn-import:hover {
            background: linear-gradient(135deg, #862e9c 0%, #702584 100%);
            transform: translateY(-2px);
        }

        .btn-dashboard {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin-top: 10px;
        }

        .btn-dashboard:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
            transform: translateY(-2px);
        }

        /* STATS SECTION */
        .stats-section {
            margin-bottom: 30px;
            animation: fadeIn 0.5s ease-out 0.2s both;
        }

        .stats-section h2 {
            color: #182848;
            margin-bottom: 25px;
            font-size: 1.7rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .stats-cards {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 25px;
        }

        @media (max-width: 768px) {
            .stats-cards {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 480px) {
            .stats-cards {
                grid-template-columns: 1fr;
            }
        }

        .stat-card {
            padding: 25px 20px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
        }

        .total::before { background: linear-gradient(90deg, #4b6cb7, #3a5ca9); }
        .highest::before { background: linear-gradient(90deg, #ff6b6b, #ff5252); }
        .lowest::before { background: linear-gradient(90deg, #51cf66, #40c057); }
        .count::before { background: linear-gradient(90deg, #9c36b5, #862e9c); }

        .stat-card h3 {
            font-size: 0.95rem;
            margin-bottom: 10px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-card p {
            font-size: 2.2rem;
            font-weight: 800;
            color: #182848;
        }

        /* LIST SECTION */
        .list-section {
            background: linear-gradient(145deg, #ffffff, #f0f0f0);
            padding: 30px;
            border-radius: 18px;
            box-shadow: 8px 8px 16px #d9d9d9, -8px -8px 16px #ffffff;
            border-left: 6px solid #9c36b5;
            animation: fadeIn 0.5s ease-out 0.4s both;
        }

        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .list-section h2 {
            color: #182848;
            font-size: 1.7rem;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 30px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid #eaeaea;
            max-height: 500px;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            min-width: 800px;
        }

        thead {
            background: linear-gradient(135deg, #4b6cb7 0%, #3a5ca9 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            padding: 20px 15px;
            text-align: left;
            font-weight: 700;
            font-size: 1.05rem;
        }

        td {
            padding: 18px 15px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }

        tbody tr {
            transition: background-color 0.2s;
        }

        tbody tr:hover {
            background-color: #f8faff;
        }

        tbody tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tbody tr:nth-child(even):hover {
            background-color: #f0f4ff;
        }

        .empty-row td {
            text-align: center;
            color: #888;
            font-style: italic;
            padding: 40px;
            font-size: 1.1rem;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        /* EXPORT SECTION */
        .export-section {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* FOOTER */
        footer {
            text-align: center;
            padding: 25px;
            background: #f8f9fa;
            color: #666;
            border-top: 1px solid #eee;
            margin-top: 20px;
        }

        footer p {
            margin: 5px 0;
        }

        .footer-links {
            margin-top: 15px;
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .footer-links a {
            color: #4b6cb7;
            text-decoration: none;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-links a:hover {
            text-decoration: underline;
        }

        /* ANIMAÇÕES */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* TIPS */
        .tips {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            padding: 20px;
            border-radius: 12px;
            margin-top: 25px;
            border-left: 5px solid #2196f3;
            animation: slideIn 0.5s ease-out;
        }

        .tips h3 {
            color: #0d47a1;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tips ul {
            list-style-type: none;
            padding-left: 10px;
        }

        .tips li {
            margin-bottom: 8px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 5px 0;
        }

        .tips li:before {
            content: "✓";
            color: #2196f3;
            font-weight: bold;
            flex-shrink: 0;
        }

        /* SCROLLBAR */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #4b6cb7 0%, #3a5ca9 100%);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #3a5ca9 0%, #2a4c99 100%);
        }

        /* NOTIFICATIONS */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            animation: slideIn 0.3s ease-out;
        }

        .notification-success {
            background: linear-gradient(135deg, #51cf66 0%, #40c057 100%);
        }

        .notification-warning {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff5252 100%);
        }

        .notification-info {
            background: linear-gradient(135deg, #4b6cb7 0%, #3a5ca9 100%);
        }

        /* CATEGORY BADGES */
        .category-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 10px;
        }

        .category-alimentacao {
            background: #e3f2fd;
            color: #1565c0;
        }

        .category-limpeza {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .category-higiene {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .category-bebidas {
            background: #fff3e0;
            color: #ef6c00;
        }

        .category-outros {
            background: #f5f5f5;
            color: #616161;
        }

        /* LOADING */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* MODAL */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            animation: fadeIn 0.3s ease-out;
        }

        .modal h2 {
            color: #182848;
            margin-bottom: 20px;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            justify-content: flex-end;
        }

        /* DASHBOARD PREVIEW */
        .dashboard-preview {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            text-align: center;
        }

        .dashboard-preview h3 {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .dashboard-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .dashboard-feature {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .dashboard-features {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-shopping-cart"></i> Lista de Compras Inteligente</h1>
            <p class="subtitle">Controle seus gastos, economize dinheiro e visualize onde você pode economizar mais</p>
            <a href="javascript:void(0);" onclick="openDashboard()" class="dashboard-link">
                <i class="fas fa-chart-bar"></i> Dashboard de Gastos
            </a>
        </header>

        <div class="app-container">
            <!-- FORMULÁRIO DE ADIÇÃO -->
            <div class="form-section">
                <h2><i class="fas fa-plus-circle"></i> Adicionar Novo Produto</h2>
                <form id="product-form">
                    <div class="form-group">
                        <label for="product-name"><i class="fas fa-tag"></i> Nome do Produto:</label>
                        <input type="text" id="product-name" placeholder="Ex: Arroz, Leite, Carne, Shampoo..." required autofocus>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="product-quantity"><i class="fas fa-balance-scale"></i> Quantidade:</label>
                            <input type="number" id="product-quantity" min="1" value="1" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="product-price"><i class="fas fa-dollar-sign"></i> Valor Unitário (R$):</label>
                            <input type="number" id="product-price" min="0.01" step="0.01" placeholder="0.00" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="product-category"><i class="fas fa-filter"></i> Categoria:</label>
                        <select id="product-category">
                            <option value="">Selecione uma categoria</option>
                            <option value="alimentacao">Alimentação</option>
                            <option value="limpeza">Limpeza</option>
                            <option value="higiene">Higiene Pessoal</option>
                            <option value="bebidas">Bebidas</option>
                            <option value="outros">Outros</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="btn-add" id="submit-btn">
                        <i class="fas fa-cart-plus"></i> Adicionar à Lista
                    </button>
                </form>

                <div class="tips">
                    <h3><i class="fas fa-lightbulb"></i> Dicas para economizar:</h3>
                    <ul>
                        <li>Compare preços de diferentes marcas</li>
                        <li>Compre em maior quantidade itens não perecíveis</li>
                        <li>Use o dashboard para identificar seus maiores gastos</li>
                        <li>Evite ir ao mercado com fome</li>
                    </ul>
                </div>

                <div class="dashboard-preview">
                    <h3><i class="fas fa-chart-bar"></i> Dashboard de Gastos</h3>
                    <p>Visualize seus gastos por dia, semana e mês com gráficos interativos</p>
                    <button onclick="openDashboard()" class="btn-dashboard">
                        <i class="fas fa-chart-line"></i> Abrir Dashboard
                    </button>
                </div>
            </div>

            <!-- CONTEÚDO PRINCIPAL -->
            <div>
                <!-- ESTATÍSTICAS -->
                <div class="stats-section">
                    <h2><i class="fas fa-chart-line"></i> Resumo dos Gastos</h2>
                    <div class="stats-cards">
                        <div class="stat-card total">
                            <h3>Total Gasto</h3>
                            <p id="total-spent">R$ 0,00</p>
                        </div>
                        <div class="stat-card highest">
                            <h3>Maior Gasto</h3>
                            <p id="highest-spent">R$ 0,00</p>
                        </div>
                        <div class="stat-card lowest">
                            <h3>Menor Gasto</h3>
                            <p id="lowest-spent">R$ 0,00</p>
                        </div>
                        <div class="stat-card count">
                            <h3>Itens na Lista</h3>
                            <p id="item-count">0</p>
                        </div>
                    </div>
                </div>

                <!-- LISTA DE PRODUTOS -->
                <div class="list-section">
                    <div class="list-header">
                        <h2><i class="fas fa-list-check"></i> Itens da Lista de Compras</h2>
                        <button id="clear-all" class="btn-clear">
                            <i class="fas fa-trash"></i> Limpar Tudo
                        </button>
                    </div>
                    
                    <div class="table-container">
                        <table id="shopping-list">
                            <thead>
                                <tr>
                                    <th>Produto</th>
                                    <th>Quantidade</th>
                                    <th>Valor Unitário</th>
                                    <th>Total Item</th>
                                    <th>Ações</th>
                                </tr>
                            </thead>
                            <tbody id="list-body">
                                <tr class="empty-row">
                                    <td colspan="5">Sua lista está vazia. Adicione produtos para começar!</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="export-section">
                        <button id="export-btn" class="btn-export">
                            <i class="fas fa-download"></i> Exportar Lista
                        </button>
                        <button id="import-btn" class="btn-import">
                            <i class="fas fa-upload"></i> Importar Lista
                        </button>
                        <input type="file" id="import-file" accept=".json" style="display: none;">
                        <button onclick="window.print()" class="btn-export">
                            <i class="fas fa-print"></i> Imprimir
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <p>Lista de Compras Inteligente &copy; 2024 - Todos os dados são salvos automaticamente no seu navegador</p>
            <p>Para usar no celular, adicione esta página à tela inicial do seu dispositivo</p>
            <div class="footer-links">
                <a href="javascript:void(0);" onclick="openDashboard()"><i class="fas fa-chart-bar"></i> Dashboard de Gastos</a>
                <a href="javascript:void(0);" onclick="showBackupModal()"><i class="fas fa-save"></i> Backup/Restauração</a>
                <a href="javascript:void(0);" onclick="showHelp()"><i class="fas fa-question-circle"></i> Ajuda</a>
                <a href="javascript:void(0);" onclick="showAbout()"><i class="fas fa-info-circle"></i> Sobre</a>
            </div>
        </footer>
    </div>

    <script>
        // ========== INICIALIZAÇÃO ==========
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Lista de Compras Inteligente iniciada!');
            
            // Inicializar aplicação
            initApp();
            
            // Mostrar mensagem de boas-vindas
            setTimeout(() => {
                if (!localStorage.getItem('appInitialized')) {
                    showNotification('Bem-vindo ao Lista de Compras Inteligente!', 'info');
                    localStorage.setItem('appInitialized', 'true');
                }
            }, 1000);
        });

        // ========== ELEMENTOS DO DOM ==========
        const productForm = document.getElementById('product-form');
        const productName = document.getElementById('product-name');
        const productQuantity = document.getElementById('product-quantity');
        const productPrice = document.getElementById('product-price');
        const productCategory = document.getElementById('product-category');
        const listBody = document.getElementById('list-body');
        const totalSpentElement = document.getElementById('total-spent');
        const highestSpentElement = document.getElementById('highest-spent');
        const lowestSpentElement = document.getElementById('lowest-spent');
        const itemCountElement = document.getElementById('item-count');
        const clearAllButton = document.getElementById('clear-all');
        const exportButton = document.getElementById('export-btn');
        const importButton = document.getElementById('import-btn');
        const importFile = document.getElementById('import-file');
        const submitBtn = document.getElementById('submit-btn');

        // ========== VARIÁVEIS GLOBAIS ==========
        let shoppingList = JSON.parse(localStorage.getItem('shoppingList')) || [];
        let lastSaveTime = Date.now();

        // ========== FUNÇÕES AUXILIARES ==========
        function formatCurrency(value) {
            return `R$ ${value.toFixed(2).replace('.', ',')}`;
        }

        function getCategoryName(categoryKey) {
            const categories = {
                'alimentacao': 'Alimentação',
                'limpeza': 'Limpeza',
                'higiene': 'Higiene',
                'bebidas': 'Bebidas',
                'outros': 'Outros'
            };
            return categories[categoryKey] || categoryKey;
        }

        function autoCategorizeProduct(productName) {
            const name = productName.toLowerCase();
            
            const categories = {
                'alimentacao': ['arroz', 'feijão', 'feijao', 'macarrão', 'macarrao', 'carne', 'frango', 'peixe', 'leite', 'ovo', 'ovos', 'queijo', 'manteiga', 'açúcar', 'acucar', 'café', 'cafe', 'óleo', 'oleo', 'sal', 'farinha', 'biscoito', 'bolacha', 'pão', 'pao', 'tomate', 'cebola', 'alho', 'fruta', 'legume', 'verdura'],
                'limpeza': ['sabão', 'sabao', 'detergente', 'água sanitária', 'agua sanitaria', 'desinfetante', 'esponja', 'pano', 'sabão em pó', 'sabao em po', 'amaciante', 'álcool', 'alcool', 'limpa vidros', 'lustra móveis', 'inseticida', 'papel higiênico', 'papel higienico', 'papel toalha', 'saco de lixo'],
                'higiene': ['shampoo', 'condicionador', 'sabonete', 'creme dental', 'pasta de dente', 'escova de dente', 'fio dental', 'desodorante', 'creme', 'protetor solar', 'absorvente', 'fralda', 'lâmina', 'lamina', 'espuma'],
                'bebidas': ['refrigerante', 'suco', 'água', 'agua', 'cerveja', 'vinho', 'whisky', 'vodka', 'energético', 'energetico', 'refri', 'refris']
            };
            
            for (const [category, keywords] of Object.entries(categories)) {
                for (const keyword of keywords) {
                    if (name.includes(keyword)) {
                        return category;
                    }
                }
            }
            
            return 'outros';
        }

        function saveList() {
            try {
                localStorage.setItem('shoppingList', JSON.stringify(shoppingList));
                lastSaveTime = Date.now();
                return true;
            } catch (error) {
                showNotification('Erro ao salvar dados! Espaço insuficiente.', 'warning');
                console.error('Erro ao salvar:', error);
                return false;
            }
        }

        function showNotification(message, type = 'info') {
            // Remover notificação anterior
            const existing = document.querySelector('.notification');
            if (existing) existing.remove();
            
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'warning' ? 'exclamation-triangle' : 'info-circle'}"></i>
                ${message}
            `;
            
            document.body.appendChild(notification);
            
            // Remover após 3 segundos
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideIn 0.3s ease-out reverse';
                    setTimeout(() => notification.remove(), 300);
                }
            }, 3000);
        }

        // ========== INICIALIZAR APLICAÇÃO ==========
        function initApp() {
            // Configurar lista
            shoppingList = JSON.parse(localStorage.getItem('shoppingList')) || [];
            
            // Adicionar IDs e categorias aos itens antigos
            shoppingList = shoppingList.map(item => {
                if (!item.id) item.id = Date.now() + Math.random();
                if (!item.date) item.date = new Date().toISOString();
                if (!item.category) item.category = autoCategorizeProduct(item.name);
                return item;
            });
            
            saveList();
            renderList();
            updateStats();
            setupEventListeners();
            
            // Verificar se precisa adicionar dados de exemplo
            if (shoppingList.length === 0) {
                setTimeout(() => {
                    if (confirm('Deseja adicionar dados de exemplo para testar o sistema?')) {
                        addSampleData();
                    }
                }, 1500);
            }
        }

        // ========== RENDERIZAR LISTA ==========
        function renderList() {
            listBody.innerHTML = '';
            
            if (shoppingList.length === 0) {
                listBody.innerHTML = `
                    <tr class="empty-row">
                        <td colspan="5">
                            <i class="fas fa-shopping-cart" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                            Sua lista está vazia. Adicione produtos para começar!
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Ordenar por data (mais recente primeiro)
            shoppingList.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            shoppingList.forEach(product => {
                const total = product.quantity * product.price;
                const date = new Date(product.date);
                const formattedDate = date.toLocaleDateString('pt-BR', { 
                    day: '2-digit', 
                    month: '2-digit'
                });
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>
                        <div style="font-weight: 600;">${product.name}</div>
                        <div style="font-size: 0.85rem; color: #666; margin-top: 5px;">
                            <i class="fas fa-calendar"></i> ${formattedDate}
                            <span class="category-badge category-${product.category}">
                                ${getCategoryName(product.category)}
                            </span>
                        </div>
                    </td>
                    <td>${product.quantity}</td>
                    <td>${formatCurrency(product.price)}</td>
                    <td><strong style="color: #182848;">${formatCurrency(total)}</strong></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-edit" data-id="${product.id}">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-delete" data-id="${product.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                `;
                
                // Adicionar event listeners para os botões
                const editBtn = row.querySelector('.btn-edit');
                const deleteBtn = row.querySelector('.btn-delete');
                
                editBtn.addEventListener('click', () => {
                    editProduct(product.id);
                });
                
                deleteBtn.addEventListener('click', () => {
                    deleteProduct(product.id);
                });
                
                listBody.appendChild(row);
            });
        }

        // ========== ATUALIZAR ESTATÍSTICAS ==========
        function updateStats() {
            if (shoppingList.length === 0) {
                totalSpentElement.textContent = 'R$ 0,00';
                highestSpentElement.textContent = 'R$ 0,00';
                lowestSpentElement.textContent = 'R$ 0,00';
                itemCountElement.textContent = '0';
                return;
            }
            
            const totals = shoppingList.map(product => product.quantity * product.price);
            const totalSpent = totals.reduce((sum, current) => sum + current, 0);
            const highestSpent = Math.max(...totals);
            const lowestSpent = Math.min(...totals);
            
            totalSpentElement.textContent = formatCurrency(totalSpent);
            highestSpentElement.textContent = formatCurrency(highestSpent);
            lowestSpentElement.textContent = formatCurrency(lowestSpent);
            itemCountElement.textContent = shoppingList.length.toString();
        }

        // ========== ADICIONAR PRODUTO ==========
        productForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<div class="loading"></div> Adicionando...';
            submitBtn.disabled = true;
            
            setTimeout(() => {
                const category = productCategory.value || autoCategorizeProduct(productName.value);
                
                const product = {
                    id: Date.now().toString() + Math.random().toString(36).substr(2, 9),
                    name: productName.value.trim(),
                    quantity: parseInt(productQuantity.value),
                    price: parseFloat(productPrice.value),
                    category: category,
                    date: new Date().toISOString()
                };
                
                // Validação
                if (!product.name || product.quantity <= 0 || product.price <= 0 || isNaN(product.price)) {
                    showNotification('Por favor, preencha todos os campos corretamente.', 'warning');
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                    return;
                }
                
                shoppingList.push(product);
                saveList();
                renderList();
                updateStats();
                
                // Limpar formulário
                productName.value = '';
                productQuantity.value = 1;
                productPrice.value = '';
                productCategory.value = '';
                productName.focus();
                
                // Restaurar botão
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                
                // Feedback
                showNotification('Produto adicionado com sucesso!', 'success');
                
            }, 500);
        });

        // ========== EDITAR PRODUTO ==========
        function editProduct(id) {
            console.log('Editando produto com ID:', id);
            
            const product = shoppingList.find(item => item.id.toString() === id.toString());
            
            if (!product) {
                showNotification('Produto não encontrado!', 'warning');
                return;
            }
            
            // Preencher formulário com dados do produto
            productName.value = product.name;
            productQuantity.value = product.quantity;
            productPrice.value = product.price;
            productCategory.value = product.category;
            
            // Remover produto da lista temporariamente
            shoppingList = shoppingList.filter(item => item.id.toString() !== id.toString());
            saveList();
            renderList();
            updateStats();
            
            // Focar no campo de nome
            productName.focus();
            
            // Feedback
            showNotification('Produto carregado para edição. Edite os campos e clique em "Adicionar à Lista".', 'info');
        }

        // ========== EXCLUIR PRODUTO ==========
        function deleteProduct(id) {
            console.log('Excluindo produto com ID:', id);
            
            if (confirm('Tem certeza que deseja remover este item da lista?')) {
                shoppingList = shoppingList.filter(item => item.id.toString() !== id.toString());
                saveList();
                renderList();
                updateStats();
                showNotification('Produto removido com sucesso!', 'warning');
            }
        }

        // ========== LIMPAR TUDO ==========
        clearAllButton.addEventListener('click', function() {
            if (shoppingList.length === 0) {
                showNotification('A lista já está vazia!', 'info');
                return;
            }
            
            if (confirm(`Tem certeza que deseja limpar TODOS os ${shoppingList.length} itens da lista? Esta ação não pode ser desfeita.`)) {
                // Criar backup antes de limpar
                const backupKey = 'backup_before_clear_' + new Date().toISOString();
                localStorage.setItem(backupKey, JSON.stringify(shoppingList));
                
                shoppingList = [];
                saveList();
                renderList();
                updateStats();
                showNotification('Lista limpa com sucesso! Um backup foi criado.', 'warning');
            }
        });

        // ========== EXPORTAR LISTA ==========
        exportButton.addEventListener('click', function() {
            if (shoppingList.length === 0) {
                showNotification('A lista está vazia. Não há nada para exportar.', 'warning');
                return;
            }
            
            const exportData = {
                shoppingList: shoppingList,
                exportDate: new Date().toISOString(),
                totalItems: shoppingList.length,
                totalValue: shoppingList.reduce((sum, item) => sum + (item.quantity * item.price), 0),
                appVersion: '1.0.0'
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const exportFileName = `lista-compras-${new Date().toISOString().slice(0,10)}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileName);
            linkElement.click();
            
            showNotification(`Lista exportada com ${shoppingList.length} itens!`, 'success');
        });

        // ========== IMPORTAR LISTA ==========
        importButton.addEventListener('click', function() {
            importFile.click();
        });

        importFile.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                try {
                    const importedData = JSON.parse(event.target.result);
                    let importedList = importedData;
                    
                    if (importedData.shoppingList) {
                        importedList = importedData.shoppingList;
                    }
                    
                    if (!Array.isArray(importedList)) {
                        throw new Error('Formato inválido');
                    }
                    
                    const itemCount = importedList.length;
                    
                    if (confirm(`Deseja importar ${itemCount} itens? A lista atual será substituída.`)) {
                        shoppingList = importedList.map(item => ({
                            ...item,
                            id: item.id || Date.now().toString() + Math.random().toString(36).substr(2, 9),
                            date: item.date || new Date().toISOString(),
                            category: item.category || autoCategorizeProduct(item.name)
                        }));
                        
                        saveList();
                        renderList();
                        updateStats();
                        showNotification(`Lista importada com ${itemCount} itens!`, 'success');
                    }
                } catch (error) {
                    showNotification('Erro ao importar arquivo. Certifique-se de que é um arquivo JSON válido.', 'warning');
                    console.error('Erro na importação:', error);
                }
                
                importFile.value = '';
            };
            
            reader.readAsText(file);
        });

        // ========== DASHBOARD ==========
        function openDashboard() {
            // Verificar se há dados
            if (shoppingList.length === 0) {
                if (confirm('Você ainda não tem dados de compras. Deseja adicionar dados de exemplo para testar o dashboard?')) {
                    addSampleData();
                    // Criar dashboard inline
                    createInlineDashboard();
                } else {
                    showNotification('Adicione alguns produtos primeiro para usar o dashboard.', 'info');
                }
            } else {
                createInlineDashboard();
            }
        }

        function createInlineDashboard() {
            // Criar modal com dashboard
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.display = 'flex';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 90%; max-height: 90vh; width: 1200px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2><i class="fas fa-chart-bar"></i> Dashboard de Gastos</h2>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" style="background: none; border: none; font-size: 1.5rem; color: #666; cursor: pointer;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                            <h3><i class="fas fa-chart-line"></i> Visão Geral</h3>
                            <div id="dashboard-stats" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                                <!-- Stats serão preenchidas por JavaScript -->
                            </div>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                            <h3><i class="fas fa-calendar"></i> Período</h3>
                            <div style="margin-top: 15px;">
                                <select id="dashboard-period" style="width: 100%; padding: 10px; border-radius: 5px; border: 1px solid #ddd;">
                                    <option value="day">Hoje</option>
                                    <option value="week">Esta Semana</option>
                                    <option value="month" selected>Este Mês</option>
                                    <option value="year">Este Ano</option>
                                    <option value="all">Todo Período</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h3><i class="fas fa-list"></i> Análise de Gastos</h3>
                        <div id="dashboard-analysis" style="margin-top: 15px;">
                            <!-- Análise será preenchida por JavaScript -->
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                            <h3><i class="fas fa-chart-pie"></i> Por Categoria</h3>
                            <div id="category-breakdown" style="margin-top: 15px; max-height: 300px; overflow-y: auto;">
                                <!-- Categorias serão preenchidas por JavaScript -->
                            </div>
                        </div>
                        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                            <h3><i class="fas fa-trophy"></i> Top Gastos</h3>
                            <div id="top-expenses" style="margin-top: 15px; max-height: 300px; overflow-y: auto;">
                                <!-- Top gastos será preenchido por JavaScript -->
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; text-align: center;">
                        <button onclick="exportDashboardData()" class="btn-export" style="margin-right: 10px;">
                            <i class="fas fa-download"></i> Exportar Análise
                        </button>
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="btn-clear">
                            <i class="fas fa-times"></i> Fechar Dashboard
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Preencher dashboard com dados
            updateDashboardData();
            
            // Adicionar evento para atualizar quando período mudar
            modal.querySelector('#dashboard-period').addEventListener('change', updateDashboardData);
        }

        function updateDashboardData() {
            const period = document.getElementById('dashboard-period')?.value || 'month';
            const now = new Date();
            
            // Filtrar dados por período
            let filteredData = [...shoppingList];
            
            if (period !== 'all') {
                filteredData = shoppingList.filter(item => {
                    const itemDate = new Date(item.date);
                    const diffTime = now - itemDate;
                    const diffDays = diffTime / (1000 * 60 * 60 * 24);
                    
                    switch(period) {
                        case 'day': return diffDays <= 1;
                        case 'week': return diffDays <= 7;
                        case 'month': return diffDays <= 30;
                        case 'year': return diffDays <= 365;
                        default: return true;
                    }
                });
            }
            
            // Calcular estatísticas
            const totals = filteredData.map(item => item.quantity * item.price);
            const total = totals.reduce((sum, val) => sum + val, 0);
            const avg = filteredData.length > 0 ? total / filteredData.length : 0;
            const max = totals.length > 0 ? Math.max(...totals) : 0;
            const min = totals.length > 0 ? Math.min(...totals) : 0;
            
            // Atualizar stats
            const statsContainer = document.getElementById('dashboard-stats');
            if (statsContainer) {
                statsContainer.innerHTML = `
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #4b6cb7;">
                        <div style="font-size: 0.9rem; color: #666;">Total Gasto</div>
                        <div style="font-size: 1.8rem; font-weight: 700; color: #182848;">${formatCurrency(total)}</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #51cf66;">
                        <div style="font-size: 0.9rem; color: #666;">Nº de Itens</div>
                        <div style="font-size: 1.8rem; font-weight: 700; color: #182848;">${filteredData.length}</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #ff6b6b;">
                        <div style="font-size: 0.9rem; color: #666;">Média por Item</div>
                        <div style="font-size: 1.8rem; font-weight: 700; color: #182848;">${formatCurrency(avg)}</div>
                    </div>
                    <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #9c36b5;">
                        <div style="font-size: 0.9rem; color: #666;">Maior Gasto</div>
                        <div style="font-size: 1.8rem; font-weight: 700; color: #182848;">${formatCurrency(max)}</div>
                    </div>
                `;
            }
            
            // Análise por categoria
            const categoryData = {};
            filteredData.forEach(item => {
                const category = item.category || 'outros';
                const total = item.quantity * item.price;
                
                if (!categoryData[category]) {
                    categoryData[category] = { total: 0, count: 0 };
                }
                
                categoryData[category].total += total;
                categoryData[category].count += 1;
            });
            
            const categoryContainer = document.getElementById('category-breakdown');
            if (categoryContainer) {
                let categoryHTML = '';
                Object.entries(categoryData).forEach(([category, data]) => {
                    const percentage = total > 0 ? (data.total / total * 100).toFixed(1) : 0;
                    categoryHTML += `
                        <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-weight: 600;">${getCategoryName(category)}</span>
                                <span>${percentage}%</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 0.9rem; color: #666;">
                                <span>${formatCurrency(data.total)}</span>
                                <span>${data.count} itens</span>
                            </div>
                            <div style="height: 8px; background: #e0e0e0; border-radius: 4px; margin-top: 5px; overflow: hidden;">
                                <div style="height: 100%; width: ${percentage}%; background: #4b6cb7; border-radius: 4px;"></div>
                            </div>
                        </div>
                    `;
                });
                
                categoryContainer.innerHTML = categoryHTML || '<p style="text-align: center; color: #666;">Nenhum dado para exibir</p>';
            }
            
            // Top gastos
            const topExpensesContainer = document.getElementById('top-expenses');
            if (topExpensesContainer) {
                const sortedItems = [...filteredData].sort((a, b) => 
                    (b.quantity * b.price) - (a.quantity * a.price)
                ).slice(0, 5);
                
                let expensesHTML = '';
                sortedItems.forEach((item, index) => {
                    const itemTotal = item.quantity * item.price;
                    expensesHTML += `
                        <div style="margin-bottom: 15px; padding-bottom: 15px; border-bottom: 1px solid #eee;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 5px;">
                                <span style="font-weight: 600;">${index + 1}. ${item.name}</span>
                                <span>${formatCurrency(itemTotal)}</span>
                            </div>
                            <div style="font-size: 0.9rem; color: #666; display: flex; justify-content: space-between;">
                                <span>${item.quantity} un.</span>
                                <span>${new Date(item.date).toLocaleDateString('pt-BR')}</span>
                            </div>
                        </div>
                    `;
                });
                
                topExpensesContainer.innerHTML = expensesHTML || '<p style="text-align: center; color: #666;">Nenhum dado para exibir</p>';
            }
            
            // Análise
            const analysisContainer = document.getElementById('dashboard-analysis');
            if (analysisContainer) {
                // Calcular gastos por dia da semana
                const daysOfWeek = ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sáb'];
                const dayTotals = Array(7).fill(0);
                
                filteredData.forEach(item => {
                    const itemDate = new Date(item.date);
                    const day = itemDate.getDay(); // 0 = Domingo, 1 = Segunda, etc.
                    dayTotals[day] += item.quantity * item.price;
                });
                
                // Encontrar dia com maior gasto
                const maxDayIndex = dayTotals.indexOf(Math.max(...dayTotals));
                const maxDay = daysOfWeek[maxDayIndex];
                
                analysisContainer.innerHTML = `
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px;">
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <div style="font-size: 0.9rem; color: #666;">Período Selecionado</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: #182848; margin-top: 5px;">
                                ${period === 'day' ? 'Hoje' : 
                                  period === 'week' ? 'Última Semana' : 
                                  period === 'month' ? 'Último Mês' : 
                                  period === 'year' ? 'Último Ano' : 'Todo Período'}
                            </div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <div style="font-size: 0.9rem; color: #666;">Dia com Mais Gastos</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: #182848; margin-top: 5px;">
                                ${maxDay} (${formatCurrency(dayTotals[maxDayIndex] || 0)})
                            </div>
                        </div>
                        <div style="background: white; padding: 15px; border-radius: 8px;">
                            <div style="font-size: 0.9rem; color: #666;">Economia Potencial*</div>
                            <div style="font-size: 1.2rem; font-weight: 700; color: #51cf66; margin-top: 5px;">
                                ${formatCurrency(total * 0.1)}
                            </div>
                        </div>
                    </div>
                    <p style="margin-top: 15px; font-size: 0.8rem; color: #666; text-align: center;">
                        *Economia de 10% poderia ser alcançada com compras mais inteligentes
                    </p>
                `;
            }
        }

        function exportDashboardData() {
            const period = document.getElementById('dashboard-period')?.value || 'month';
            const now = new Date();
            
            // Filtrar dados
            let filteredData = [...shoppingList];
            if (period !== 'all') {
                filteredData = shoppingList.filter(item => {
                    const itemDate = new Date(item.date);
                    const diffTime = now - itemDate;
                    const diffDays = diffTime / (1000 * 60 * 60 * 24);
                    
                    switch(period) {
                        case 'day': return diffDays <= 1;
                        case 'week': return diffDays <= 7;
                        case 'month': return diffDays <= 30;
                        case 'year': return diffDays <= 365;
                        default: return true;
                    }
                });
            }
            
            const exportData = {
                periodo: period,
                dataExportacao: new Date().toISOString(),
                totalItens: filteredData.length,
                totalGasto: filteredData.reduce((sum, item) => sum + (item.quantity * item.price), 0),
                itens: filteredData,
                analise: "Dashboard de Gastos - Lista de Compras Inteligente"
            };
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const exportFileName = `dashboard-${period}-${new Date().toISOString().slice(0,10)}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileName);
            linkElement.click();
            
            showNotification('Dashboard exportado com sucesso!', 'success');
        }

        // ========== DADOS DE EXEMPLO ==========
        function addSampleData() {
            const sampleProducts = [
                { name: 'Arroz Integral 5kg', quantity: 1, price: 28.90, category: 'alimentacao' },
                { name: 'Feijão Carioca 1kg', quantity: 2, price: 9.50, category: 'alimentacao' },
                { name: 'Macarrão Espaguete 500g', quantity: 3, price: 5.30, category: 'alimentacao' },
                { name: 'Carne Bovina (kg)', quantity: 2, price: 45.90, category: 'alimentacao' },
                { name: 'Peito de Frango (kg)', quantity: 1.5, price: 22.75, category: 'alimentacao' },
                { name: 'Leite Integral 1L', quantity: 6, price: 5.90, category: 'alimentacao' },
                { name: 'Ovos (dúzia)', quantity: 1, price: 14.90, category: 'alimentacao' },
                { name: 'Sabão em Pó 2kg', quantity: 1, price: 26.90, category: 'limpeza' },
                { name: 'Detergente Líquido 500ml', quantity: 2, price: 4.50, category: 'limpeza' },
                { name: 'Shampoo Anticaspa 400ml', quantity: 1, price: 24.90, category: 'higiene' },
                { name: 'Creme Dental 90g', quantity: 2, price: 8.80, category: 'higiene' },
                { name: 'Refrigerante Coca-Cola 2L', quantity: 2, price: 8.90, category: 'bebidas' },
                { name: 'Água Mineral 500ml', quantity: 12, price: 2.50, category: 'bebidas' },
                { name: 'Café em Pó 500g', quantity: 1, price: 18.90, category: 'alimentacao' },
                { name: 'Açúcar Cristal 1kg', quantity: 1, price: 5.90, category: 'alimentacao' },
                { name: 'Óleo de Soja 900ml', quantity: 2, price: 8.90, category: 'alimentacao' },
                { name: 'Sal Refinado 1kg', quantity: 1, price: 3.90, category: 'alimentacao' },
                { name: 'Papel Higiênico 30m', quantity: 1, price: 19.90, category: 'limpeza' },
                { name: 'Sabonete em Barra', quantity: 4, price: 3.90, category: 'higiene' },
                { name: 'Desodorante Aerosol', quantity: 1, price: 16.90, category: 'higiene' }
            ];
            
            const today = new Date();
            
            sampleProducts.forEach((product, index) => {
                const purchaseDate = new Date(today);
                purchaseDate.setDate(purchaseDate.getDate() - Math.floor(Math.random() * 30));
                purchaseDate.setHours(Math.floor(Math.random() * 24));
                purchaseDate.setMinutes(Math.floor(Math.random() * 60));
                
                shoppingList.push({
                    id: Date.now().toString() + index + Math.random().toString(36).substr(2, 9),
                    name: product.name,
                    quantity: product.quantity,
                    price: product.price,
                    category: product.category,
                    date: purchaseDate.toISOString()
                });
            });
            
            saveList();
            renderList();
            updateStats();
            showNotification('Dados de exemplo adicionados com sucesso!', 'success');
        }

        // ========== CONFIGURAR EVENT LISTENERS ==========
        function setupEventListeners() {
            // Fechar modais com Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    document.querySelectorAll('.modal').forEach(modal => {
                        modal.style.display = 'none';
                    });
                }
                
                // Atalhos
                if (e.ctrlKey) {
                    switch(e.key.toLowerCase()) {
                        case 's':
                            e.preventDefault();
                            exportButton.click();
                            break;
                        case 'l':
                            e.preventDefault();
                            productName.focus();
                            break;
                    }
                }
            });
            
            // Auto-save
            setInterval(() => {
                if (shoppingList.length > 0 && Date.now() - lastSaveTime > 30000) {
                    saveList();
                    console.log('Auto-save realizado');
                }
            }, 30000);
        }

        // ========== EXPOR FUNÇÕES GLOBAIS ==========
        window.editProduct = editProduct;
        window.deleteProduct = deleteProduct;
        window.openDashboard = openDashboard;
        window.showBackupModal = showBackupModal;
        window.showHelp = showHelp;
        window.showAbout = showAbout;
        window.closeModal = closeModal;
        window.createBackup = createBackup;
        window.restoreBackup = restoreBackup;
        window.exportDashboardData = exportDashboardData;
        window.addSampleData = addSampleData;
    </script>
</body>
</html>
